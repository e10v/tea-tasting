
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python package for the statistical analysis of A/B tests">
      
      
        <meta name="author" content="Evgeny Ivanov">
      
      
        <link rel="canonical" href="https://tea-tasting.e10v.me/data-backends/">
      
      
        <link rel="prev" href="../user-guide/">
      
      
        <link rel="next" href="../power-analysis/">
      
      
        
      
      
      <link rel="icon" href="../assets/tea-cup-white-on-black.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Data backends - tea-tasting: statistical analysis of A/B tests</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-backends" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="tea-tasting: statistical analysis of A/B tests" class="md-header__button md-logo" aria-label="tea-tasting: statistical analysis of A/B tests" data-md-component="logo">
      
  <img src="../assets/tea-cup-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            tea-tasting: statistical analysis of A/B tests
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data backends
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-orange" data-md-color-accent="deep-orange"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/e10v/tea-tasting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    e10v/tea-tasting
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="tea-tasting: statistical analysis of A/B tests" class="md-nav__button md-logo" aria-label="tea-tasting: statistical analysis of A/B tests" data-md-component="logo">
      
  <img src="../assets/tea-cup-white.svg" alt="logo">

    </a>
    tea-tasting: statistical analysis of A/B tests
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/e10v/tea-tasting" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    e10v/tea-tasting
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    User guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Data backends
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Data backends
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intro
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Demo database
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-experimental-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Querying experimental data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ibis-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ibis example
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Experiment analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-with-cuped" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example with CUPED
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polars-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Polars example
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../power-analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Power analysis
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../multiple-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiple testing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom-metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom metrics
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulated-experiments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Simulated experiments
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    API reference
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8" id="__nav_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    API reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../api/metrics/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Metrics
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Metrics
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metrics/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metrics/mean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mean
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metrics/nonparametric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nonparametric
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metrics/proportion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Proportion
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/metrics/resampling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resampling
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/experiment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Experiment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/multiplicity/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multiplicity
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Global configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/aggr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Aggregates
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utilities
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      
        Intro
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Demo database
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#querying-experimental-data" class="md-nav__link">
    <span class="md-ellipsis">
      
        Querying experimental data
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ibis-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ibis example
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Experiment analysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-with-cuped" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example with CUPED
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#polars-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Polars example
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="data-backends">Data backends<a class="headerlink" href="#data-backends" title="Permanent link">#</a></h1>
<h2 id="intro">Intro<a class="headerlink" href="#intro" title="Permanent link">#</a></h2>
<p>tea-tasting supports a wide range of data backends such as BigQuery, ClickHouse, PostgreSQL, Snowflake, Trino, and many other backends supported by <a href="https://github.com/ibis-project/ibis" rel="noopener" target="_blank">Ibis</a>. Ibis is a DataFrame API to various data backends.</p>
<p>Many statistical tests, such as the Student's t-test or the Z-test, require only aggregated data for analysis. For these tests, tea-tasting retrieves only aggregated statistics like mean and variance instead of downloading all detailed data.</p>
<p>For example, if the raw experimental data are stored in ClickHouse, it's faster and more efficient to calculate counts, averages, variances, and covariances directly in ClickHouse rather than fetching granular data and performing aggregations in a Python environment.</p>
<p>tea-tasting also accepts dataframes supported by <a href="https://github.com/narwhals-dev/narwhals" rel="noopener" target="_blank">Narwhals</a>: cuDF, Daft, Dask, DuckDB, Modin, pandas, Polars, PyArrow, PySpark. Narwhals is a compatibility layer between dataframe libraries.</p>
<p>This guide:</p>
<ul>
<li>Shows how to use tea-tasting with a data backend of your choice for the analysis of an experiment.</li>
<li>Explains some internals of how tea-tasting uses Ibis to work with data backends.</li>
</ul>
<h2 id="demo-database">Demo database<a class="headerlink" href="#demo-database" title="Permanent link">#</a></h2>
<div class="admonition">
<p class="admonition-title">Note</p>
<p>This guide uses <a href="https://github.com/duckdb/duckdb" rel="noopener" target="_blank">DuckDB</a>, an in-process analytical database, and <a href="https://github.com/pola-rs/polars" rel="noopener" target="_blank">Polars</a> as example backends. Install these packages in addition to tea-tasting to reproduce the examples:</p>
<div class="highlight"><pre><span></span><code>uv<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>ibis-framework<span class="o">[</span>duckdb<span class="o">]</span><span class="w"> </span>polars
</code></pre></div>
</div>
<p>First, let's prepare a demo database:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">ibis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">polars</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">tea_tasting</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tt</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">users_data</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">make_users_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span> <span class="o">=</span> <span class="n">ibis</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;duckdb://&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s2">&quot;users_data&quot;</span><span class="p">,</span> <span class="n">users_data</span><span class="p">)</span>
<span class="go">DatabaseTable: memory.main.users_data</span>
<span class="go">  user     int64</span>
<span class="go">  variant  int64</span>
<span class="go">  sessions int64</span>
<span class="go">  orders   int64</span>
<span class="go">  revenue  float64</span>
</code></pre></div>
<p>In the example above:</p>
<ul>
<li>Function <code>tt.make_users_data</code> returns a PyArrow Table with example experimental data.</li>
<li>Function <code>ibis.duckdb.connect</code> creates a DuckDB in-process database using Ibis API.</li>
<li>Method <code>con.create_table</code> creates and populates a table in the database based on the PyArrow Table.</li>
</ul>
<p>See the <a href="https://ibis-project.org/reference/connection" rel="noopener" target="_blank">Ibis documentation on how to create connections</a> to other data backends.</p>
<h2 id="querying-experimental-data">Querying experimental data<a class="headerlink" href="#querying-experimental-data" title="Permanent link">#</a></h2>
<p>The <code>con.create_table</code> method in the example above returns an Ibis Table that can already be used for experiment analysis. But let's see how to use an SQL query to create an Ibis Table:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;select * from users_data&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">SQLQueryResult</span>
<span class="go">  query:</span>
<span class="go">    select * from users_data</span>
<span class="go">  schema:</span>
<span class="go">    user     int64</span>
<span class="go">    variant  int64</span>
<span class="go">    sessions int64</span>
<span class="go">    orders   int64</span>
<span class="go">    revenue  float64</span>
</code></pre></div>
<p>It's a very simple query. In the real world, you might need to use joins, aggregations, and CTEs to get the data. You can define any SQL query supported by your data backend and use it to create an Ibis Table.</p>
<p>Keep in mind that tea-tasting assumes that:</p>
<ul>
<li>Data is grouped by randomization units, such as individual users.</li>
<li>There is a column indicating the variant of the A/B test (typically labeled as A, B, etc.).</li>
<li>All necessary columns for metric calculations (like the number of orders, revenue, etc.) are included in the table.</li>
</ul>
<p>Ibis Table is a lazy object. It doesn't fetch the data when created. You can use Ibis DataFrame API to query the table and fetch the result:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">┏━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━┳━━━━━━━━━┓</span>
<span class="go">┃ user  ┃ variant ┃ sessions ┃ orders ┃ revenue ┃</span>
<span class="go">┡━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━╇━━━━━━━━━┩</span>
<span class="go">│ int64 │ int64   │ int64    │ int64  │ float64 │</span>
<span class="go">├───────┼─────────┼──────────┼────────┼─────────┤</span>
<span class="go">│     0 │       1 │        2 │      1 │    9.17 │</span>
<span class="go">│     1 │       0 │        2 │      1 │    6.43 │</span>
<span class="go">│     2 │       1 │        2 │      1 │    7.94 │</span>
<span class="go">│     3 │       1 │        2 │      1 │   15.93 │</span>
<span class="go">│     4 │       0 │        1 │      1 │    7.14 │</span>
<span class="go">└───────┴─────────┴──────────┴────────┴─────────┘</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
<h2 id="ibis-example">Ibis example<a class="headerlink" href="#ibis-example" title="Permanent link">#</a></h2>
<p>To better understand what Ibis does, let's consider the example with grouping and aggregation by variants:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">aggr_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="s2">&quot;variant&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sessions_per_user</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">sessions</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">orders_per_session</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">orders</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="n">data</span><span class="o">.</span><span class="n">sessions</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">orders_per_user</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">orders</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">revenue_per_user</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">revenue</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aggr_data</span>
<span class="go">r0 := SQLQueryResult</span>
<span class="go">  query:</span>
<span class="go">    select * from users_data</span>
<span class="go">  schema:</span>
<span class="go">    user     int64</span>
<span class="go">    variant  int64</span>
<span class="go">    sessions int64</span>
<span class="go">    orders   int64</span>
<span class="go">    revenue  float64</span>

<span class="go">Aggregate[r0]</span>
<span class="go">  groups:</span>
<span class="go">    variant: r0.variant</span>
<span class="go">  metrics:</span>
<span class="go">    sessions_per_user:  Mean(r0.sessions)</span>
<span class="go">    orders_per_session: Mean(r0.orders) / Mean(r0.sessions)</span>
<span class="go">    orders_per_user:    Mean(r0.orders)</span>
<span class="go">    revenue_per_user:   Mean(r0.revenue)</span>
</code></pre></div>
<p><code>aggr_data</code> is another Ibis Table defined as a query over the previously defined <code>data</code>. Let's fetch the result:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">aggr_data</span><span class="p">)</span>
<span class="go">┏━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓</span>
<span class="go">┃ variant ┃ sessions_per_user ┃ orders_per_session ┃ orders_per_user ┃ revenue_per_user ┃</span>
<span class="go">┡━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩</span>
<span class="go">│ int64   │ float64           │ float64            │ float64         │ float64          │</span>
<span class="go">├─────────┼───────────────────┼────────────────────┼─────────────────┼──────────────────┤</span>
<span class="go">│       0 │          1.996045 │           0.265726 │        0.530400 │         5.241028 │</span>
<span class="go">│       1 │          1.982802 │           0.289031 │        0.573091 │         5.730111 │</span>
<span class="go">└─────────┴───────────────────┴────────────────────┴─────────────────┴──────────────────┘</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ibis</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">interactive</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div>
<p>Internally, Ibis compiles a Table to an SQL query supported by the backend:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">aggr_data</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">pretty</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">SELECT</span>
<span class="go">  &quot;t0&quot;.&quot;variant&quot;,</span>
<span class="go">  AVG(&quot;t0&quot;.&quot;sessions&quot;) AS &quot;sessions_per_user&quot;,</span>
<span class="go">  AVG(&quot;t0&quot;.&quot;orders&quot;) / AVG(&quot;t0&quot;.&quot;sessions&quot;) AS &quot;orders_per_session&quot;,</span>
<span class="go">  AVG(&quot;t0&quot;.&quot;orders&quot;) AS &quot;orders_per_user&quot;,</span>
<span class="go">  AVG(&quot;t0&quot;.&quot;revenue&quot;) AS &quot;revenue_per_user&quot;</span>
<span class="go">FROM (</span>
<span class="go">  SELECT</span>
<span class="go">    *</span>
<span class="go">  FROM users_data</span>
<span class="go">) AS &quot;t0&quot;</span>
<span class="go">GROUP BY</span>
<span class="go">  1</span>
</code></pre></div>
<p>See <a href="https://ibis-project.org/tutorials/getting_started" rel="noopener" target="_blank">Ibis documentation</a> for more details.</p>
<h2 id="experiment-analysis">Experiment analysis<a class="headerlink" href="#experiment-analysis" title="Permanent link">#</a></h2>
<p>The example above shows how to query metric averages. But for statistical inference, this is not enough. For example, Student's t-test and Z-test also require the number of rows and variances. Additionally, analysis of ratio metrics and variance reduction with CUPED require covariances.</p>
<p>Querying all the required statistics manually can be a daunting and error-prone task. But don't worry—tea-tasting does this work for you. You just need to specify the metrics:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sessions_per_user</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">orders_per_session</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">RatioOfMeans</span><span class="p">(</span><span class="s2">&quot;orders&quot;</span><span class="p">,</span> <span class="s2">&quot;sessions&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">orders_per_user</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="s2">&quot;orders&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">revenue_per_user</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="s2">&quot;revenue&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">experiment</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">            metric control treatment rel_effect_size rel_effect_size_ci pvalue</span>
<span class="go"> sessions_per_user    2.00      1.98          -0.66%      [-3.7%, 2.5%]  0.674</span>
<span class="go">orders_per_session   0.266     0.289            8.8%      [-0.89%, 19%] 0.0762</span>
<span class="go">   orders_per_user   0.530     0.573            8.0%       [-2.0%, 19%]  0.118</span>
<span class="go">  revenue_per_user    5.24      5.73            9.3%       [-2.4%, 22%]  0.123</span>
</code></pre></div>
<p>In the example above, tea-tasting fetches all the required statistics with a single query and then uses them to analyze the experiment.</p>
<p>Some statistical methods, like bootstrap, require granular data for analysis. In this case, tea-tasting fetches the detailed data as well.</p>
<h2 id="example-with-cuped">Example with CUPED<a class="headerlink" href="#example-with-cuped" title="Permanent link">#</a></h2>
<p>An example of a slightly more complicated analysis using variance reduction with CUPED:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">users_data_cuped</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">make_users_data</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">covariates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">con</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="s2">&quot;users_data_cuped&quot;</span><span class="p">,</span> <span class="n">users_data_cuped</span><span class="p">)</span>
<span class="go">DatabaseTable: memory.main.users_data_cuped</span>
<span class="go">  user               int64</span>
<span class="go">  variant            int64</span>
<span class="go">  sessions           int64</span>
<span class="go">  orders             int64</span>
<span class="go">  revenue            float64</span>
<span class="go">  sessions_covariate int64</span>
<span class="go">  orders_covariate   int64</span>
<span class="go">  revenue_covariate  float64</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">data_cuped</span> <span class="o">=</span> <span class="n">con</span><span class="o">.</span><span class="n">sql</span><span class="p">(</span><span class="s2">&quot;select * from users_data_cuped&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment_cuped</span> <span class="o">=</span> <span class="n">tt</span><span class="o">.</span><span class="n">Experiment</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">sessions_per_user</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="s2">&quot;sessions&quot;</span><span class="p">,</span> <span class="s2">&quot;sessions_covariate&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">orders_per_session</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">RatioOfMeans</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">numer</span><span class="o">=</span><span class="s2">&quot;orders&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">denom</span><span class="o">=</span><span class="s2">&quot;sessions&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">numer_covariate</span><span class="o">=</span><span class="s2">&quot;orders_covariate&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">denom_covariate</span><span class="o">=</span><span class="s2">&quot;sessions_covariate&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="n">orders_per_user</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="s2">&quot;orders&quot;</span><span class="p">,</span> <span class="s2">&quot;orders_covariate&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">revenue_per_user</span><span class="o">=</span><span class="n">tt</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="s2">&quot;revenue&quot;</span><span class="p">,</span> <span class="s2">&quot;revenue_covariate&quot;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_cuped</span> <span class="o">=</span> <span class="n">experiment_cuped</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">data_cuped</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result_cuped</span>
<span class="go">            metric control treatment rel_effect_size rel_effect_size_ci  pvalue</span>
<span class="go"> sessions_per_user    2.00      1.98          -0.68%      [-3.2%, 1.9%]   0.603</span>
<span class="go">orders_per_session   0.262     0.293             12%        [4.2%, 21%] 0.00229</span>
<span class="go">   orders_per_user   0.523     0.581             11%        [2.9%, 20%] 0.00733</span>
<span class="go">  revenue_per_user    5.12      5.85             14%        [3.8%, 26%] 0.00674</span>
</code></pre></div>
<h2 id="polars-example">Polars example<a class="headerlink" href="#polars-example" title="Permanent link">#</a></h2>
<p>Here’s an example of how to analyze data using a Polars DataFrame:</p>
<div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">data_polars</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">from_arrow</span><span class="p">(</span><span class="n">users_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">experiment</span><span class="o">.</span><span class="n">analyze</span><span class="p">(</span><span class="n">data_polars</span><span class="p">)</span>
<span class="go">            metric control treatment rel_effect_size rel_effect_size_ci pvalue</span>
<span class="go"> sessions_per_user    2.00      1.98          -0.66%      [-3.7%, 2.5%]  0.674</span>
<span class="go">orders_per_session   0.266     0.289            8.8%      [-0.89%, 19%] 0.0762</span>
<span class="go">   orders_per_user   0.530     0.573            8.0%       [-2.0%, 19%]  0.118</span>
<span class="go">  revenue_per_user    5.24      5.73            9.3%       [-2.4%, 22%]  0.123</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © Evgeny Ivanov <br> The logo is designed by <a href="http://www.freepik.com/">Freepik</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.code.copy", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.top", "navigation.tracking", "search.highlight", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/override-copy.js"></script>
      
    
  </body>
</html>